# CMD внутри Dockerfile определяет программу, которая будет запущена в контейнере в процессе его старта 
# почему дефолтный контейнер например с Ubuntu запускается и сразу завершается?
# в Dockerfile Ubuntu указано 'CMD ["bash"]', но процесс bash не похож например на процесс веб-сервера или БД
# это shell, который слушает input c терминала и если не может найти терминал, то завершается
# то есть при запуске docker run ubuntu запускается bash, по умолчанию Docker не аттачит терминал к контейнеру при старте
# bash не находит терминал и завершается сразу после старта, соответственно и контейнер также завершается
# мы можем разово переопределить дефолтную команду при запуске контейнера - docker run ubuntu sleep 5
# в этом случае контейнер запускается, выполняет указанную нами команду и завершается
# если же мы хотим переопределить команду при запуске контейнера на постоянной основе, то нам необходимо пересобрать образ:
FROM ununtu
CMD sleep 5   #либо команда в формате JSON - CMD ["sleep", "5"]
# при задании команды в формате JSON важно помнить, что первый элемент массива должен быть executable
# нельзя писать CMD ["sleep 5"], команда и ее параметр должны быть отдельными элементами массива
# если мы соберем новый образ из Dockerfile выше, то при запуске docker run ubuntu-sleeper, контейнер будет выполнять команду sleep 5 и завершаться
# если мы захотим переопределить значение sleep на 10, нужно будет запускать docker run ubuntu-sleeper sleep 10, что не очень красиво
# чтобы мы могли запускать контейнер командой docker run ubuntu-sleeper 10, нам нужно использовать инструкцию ENTRYPOINT
FROM ubuntu
ENTRYPOINT ["sleep"]
# инструкция ENTRYPOINT очень похожа на CMD, но при запуске контейнера docker run ubuntu-sleeper 10, значение 10 будет добавлено к команде sleep
# если мы запустим контейнер docker run ubuntu-sleeper без указания параметра, то получим ошибку sleep: missing operand
# чтобы задать некое дефолтное значение для sleep, мы можем объединить ENTRYPOINT и CMD:
FROM ubuntu
ENTRYPOINT ["sleep"]
CMD ["5"]
# то есть при запуске контейнера без параметров, он запустится с командой sleep 5, если мы укажем docker run ubuntu-sleeper 10, 
# то новое значение переопределит значение из CMD
# важно! при комбинации ENTRYPOINT и CMD, необходимо использовать JSON-формат

docker run --entrypoint sleep2.0 ubuntu-sleeper 10   #если нам нужно переопределить дефолтную команду из инструкции ENTRYPOINT 
